<link rel="stylesheet" type="text/css" media="screen" href="css/dashboard.css">

<div class="main-app-box" id="dashboard">

	<div class="tabs-contents">

		<div class="tab-content active" id="dashboard-about-me">
			<table class="props">
				<tr><td class="key">User Name</td><td>${config.meObj.name}</td></tr>
				<tr><td class="key">ID</td><td>${config.meObj.id}</td></tr>
				<tr><td class="key">E-Mail</td><td>${config.meObj.eMail || ''}</td></tr>
				<tr><td class="key">Working Directory</td><td>${config.meObj.workingDirectory ? config.meObj.workingDirectory.name : ''}</td></tr>
				<tr><td class="key">Session ID(s)</td><td>${config.meObj.sessionIds.join('<br>')}</td></tr>
				<tr><td class="key">Groups</td><td>${config.meObj.groups.map(function(g) { return g.name; }).join(', ')}</td></tr>
			</table>

		</div>

		<div class="tab-content" id="dashboard-about-structr">

			<table class="props">
				<tr><td class="key">Version</td><td>${config.envInfo.version} ${config.envInfo.build} ${config.envInfo.date} <span id="version-update-info"></span></td></tr>
				<tr><td class="key">Edition</td><td><i title="Structr ${config.envInfo.edition} Edition" class="${_Icons.getFullSpriteClass(_Icons.getIconForEdition(config.envInfo.edition))}"></i> (Structr ${config.envInfo.edition} Edition)</td></tr>
				<tr><td class="key">Modules</td><td>${Object.keys(config.envInfo.modules).join(', ')}</td></tr>
				<tr><td class="key">Licensee</td><td>${config.envInfo.licensee || 'Unlicensed'}</td></tr>
				<tr><td class="key">Host ID</td><td>${config.envInfo.hostId || ''}</td></tr>
				<tr><td class="key">License Start Date</td><td>${config.envInfo.startDate || '-'}</td></tr>
				<tr><td class="key">License End Date</td><td class="end-date">${config.envInfo.endDate || '-'}</td></tr>
				<tr><td class="key">Database Driver</td><td class="db-driver">${config.databaseDriver}</td></tr>
			</table>
		</div>

		<div class="tab-content" id="dashboard-deployment">

			<div class="dashboard-grid-wrapper">

				<div class="dashboard-grid-row">
					<h2>Application Import and Export</h2>
				</div>

				<div>
					<h3>Application import from server directory</h3>
					<div>
						<input type="text" id="deployment-source-input" placeholder="Server directory path for app import">
						<button class="action" id="do-app-import">Import app from server directory</button>
					</div>
				</div>

				<div>
					<h3>Application export to server directory</h3>
					<div>
						<input type="text" id="app-export-target-input" placeholder="Server directory path for app export">
						<button class="action" id="do-app-export">Export app to server directory</button>
					</div>
				</div>

				<div>
					<h3>Import application from URL or upload a ZIP file</h3>
					${(config.deployServletAvailable ? '' : '<span class="deployment-warning">Deployment via URL is not possible because <code>DeployServlet</code> is not running.</span>')}
					<div>
						<input type="text" id="deployment-url-input" placeholder="Download URL of ZIP file for app import" name="downloadUrl" ${(config.deployServletAvailable ? '' : 'disabled')}>
						<input type="file" id="deployment-file-input" placeholder="Upload ZIP file" ${(config.deployServletAvailable ? '' : 'disabled')}>
						<button class="action ${(config.deployServletAvailable ? '' : 'disabled')}" ${(config.deployServletAvailable ? '' : 'disabled')} id="do-app-import-from-zip">Import app from ZIP file</button>
					</div>
				</div>

				<div>
					<h3>Export application and download as ZIP file</h3>
					${(config.deployServletAvailable ? '' : '<span class="deployment-warning">Export and download as ZIP file is not possible because <code>DeployServlet</code> is not running.</span>')}
					<div>
						<input type="text" id="zip-export-prefix" placeholder="ZIP File prefix" ${(config.deployServletAvailable ? '' : 'disabled')} value="${(config.zipExportPrefix || 'webapp')}">
						<label class="checkbox-label"><input type="checkbox" id="zip-export-append-timestamp" ${(config.deployServletAvailable ? '' : 'disabled')} ${(config.zipExportAppendTimestamp ? 'checked' : '')}> Append timestamp</label>
						<button class="action ${(config.deployServletAvailable ? '' : 'disabled')}" ${(config.deployServletAvailable ? '' : 'disabled')} id="do-app-export-to-zip">Export and download app as ZIP file</button>
					</div>
				</div>

				<div class="dashboard-grid-row">
					<hr>
				</div>

				<div class="dashboard-grid-row">
					<h2>Data Import and Export</h2>
				</div>

				<div>
					<h3>Data import from server directory</h3>
					<div>
						<input type="text" id="data-import-source-input" placeholder="Local directory path for data import">
						<label class="checkbox-label"><input type="checkbox" id="data-import-rebuild-indexes" ${(config.dataImportRebuildIndexes ? 'checked' : '')}> Rebuild all indexes after data import</label>
						<button class="action" id="do-data-import">Import data from server directory</button>
					</div>
				</div>

				<div>
					<h3>Data export to server directory</h3>
					<div>
						<input type="text" id="data-export-target-input" placeholder="Server directory path for data export">
						<select id="data-export-types-input" class="chosen-sortable" data-placeholder="Please select data type(s) to export" multiple="multiple">
							<optgroup label="Custom Types" class="custom-types"></optgroup>
							<optgroup label="Builtin Types" class="builtin-types"></optgroup>
						</select>
						<button class="action" id="do-data-export">Export data to server directory</button>
					</div>
				</div>

				<div>
					<h3>Import data from URL or upload a ZIP file</h3>
					${(config.deployServletAvailable ? '' : '<span class="deployment-warning">Deployment via URL is not possible because <code>DeployServlet</code> is not running.</span>')}
					<div>
						<input type="text" id="data-deployment-url-input" placeholder="Download URL of ZIP file for data import" name="downloadUrl" ${(config.deployServletAvailable ? '' : 'disabled')}>
						<input type="file" id="data-deployment-file-input" placeholder="Upload ZIP file" ${(config.deployServletAvailable ? '' : 'disabled')}>
						<label class="checkbox-label"><input type="checkbox" id="zip-data-import-rebuild-indexes" ${(config.zipDataImportRebuildIndexes ? 'checked' : '')}> Rebuild all indexes after data import</label>
						<button id="do-data-import-from-zip" class="action ${(config.deployServletAvailable ? '' : 'disabled')}" ${(config.deployServletAvailable ? '' : 'disabled')}>Import data from ZIP file</button>
					</div>
				</div>

				<div>
					<h3>Export data and download as ZIP file</h3>
					${(config.deployServletAvailable ? '' : '<span class="deployment-warning">Export and download data as ZIP file is not possible because <code>DeployServlet</code> is not running.</span>')}
					<div>
						<input type="text" id="zip-data-export-prefix" placeholder="ZIP file prefix" ${(config.deployServletAvailable ? '' : 'disabled')} value="${(config.zipDataExportPrefix || 'data')}">
						<select id="zip-data-export-types-input" class="chosen-sortable" data-placeholder="Please select data type(s) to export" multiple="multiple">
							<optgroup label="Custom Types" class="custom-types"></optgroup>
							<optgroup label="Builtin Types" class="builtin-types"></optgroup>
						</select>
						<label class="checkbox-label"><input type="checkbox" id="zip-data-export-append-timestamp" ${(config.deployServletAvailable ? '' : 'disabled')} ${(config.zipDataExportAppendTimestamp ? 'checked' : '')}> Append timestamp</label>
						<button id="do-data-export-to-zip" class="action ${(config.deployServletAvailable ? '' : 'disabled')}" ${(config.deployServletAvailable ? '' : 'disabled')}>Export and download data as ZIP file</button>
					</div>
				</div>
			</div>
		</div>

		<div class="tab-content" id="dashboard-global-schema-methods">

		</div>

		<div class="tab-content" id="dashboard-server-log">

			<div id="dashboard-server-log-controls">

				<label>Refresh Interval:</label>
				<select id="dashboard-server-log-refresh-interval">
					<option value="10000">10s</option>
					<option value="5000">5s</option>
					<option value="2000">2s</option>
					<option value="1000">1s</option>
					<option value="-1">manual</option>
				</select>

				<span class="dashboard-spacer"></span>

				<label>Number of lines: </label>
				<input id="dashboard-server-log-lines" type="number">

				<span class="dashboard-spacer"></span>

				<button id="dashboard-server-log-manual-refresh" class="action">Refresh</button>
				<button id="dashboard-server-log-copy" class="action">Copy</button>

				<span class="dashboard-spacer"></span>

				<span id="dashboard-server-log-feedback"></span>
			</div>

			<textarea readonly="readonly"></textarea>
		</div>

		<div class="tab-content" id="dashboard-sysinfo">

		</div>

		<div class="tab-content" id="dashboard-ui-config">

			<div class="flex">

				<div class="flex flex-col mr-12">

					<div class="flex menu-order-container">
						<div class="text-center font-bold w-40 p-4">Main Menu</div>
						<div class="text-center font-bold w-40 p-4">Custom Menu (â˜°)</div>
					</div>

					<div class="flex menu-order-container">
						<div id="main-menu-entries-config" class="connectedSortable menu-order-config-container"></div>
						<div id="sub-menu-entries-config" class="connectedSortable menu-order-config-container"></div>
					</div>
				</div>

				<div class="flex flex-col mr-12">

					<div class="text-center font-bold p-4 w-full">Misc UI Settings</div>

					<div id="settings-container">

					</div>

					<div>
						<button class="action" id="clear-local-storage-on-server">Reset <strong>all</strong> stored UI settings</button>
					</div>
				</div>
			</div>
		</div>

		<div class="tab-content" id="dashboard-event-log">

			<div id="event-log-options">
				<label>Filter: </label>
				<select id="event-type-filter">
					<option value="">All events</option>
					<option value="Authentication">Authentication events</option>
					<option value="Cron">Cron events</option>
<!--				<option value="GraphQL">GraphQL requests</option>-->
					<option value="Http">Http requests</option>
					<option value="Maintenance">Maintenance</option>
					<option value="Scripting">Scripting events</option>
					<option value="Rest">REST requests</option>
					<option value="ResourceAccess">ResourceAccess events</option>
					<option value="Transaction">Transactions</option>
					<option value="SystemInfo">SystemInfo</option>
				</select>
				<label>Number of events to show: </label>
				<input id="event-type-page-size" type="number" size="6" value="100" />
				<button id="refresh-event-log"><i class="sprite sprite-arrow_refresh"></i> Refresh</button>
			</div>

			<table class="props">
				<thead>
                    <tr>
                        <th style="text-align: left;">Timestamp</th>
                        <th style="text-align: left;">Type</th>
                        <th style="text-align: left;">Detail</th>
                        <th style="text-align: left;">Data</th>
                        <th style="text-align: left;">Actions</th>
                    </tr>
				</thead>
				<tbody id="event-log-container">

                </tbody>
			</table>
		</div>

	</div>

</div>